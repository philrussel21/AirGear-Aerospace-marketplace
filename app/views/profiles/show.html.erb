<p id="notice"><%= notice %></p>
<div class="profile-pic w-full mb-4">
  <%if @profile.picture.attached?%>
    <%= image_tag @profile.picture, alt: "Company Profile Pic", class: "w-full max-w-sm rounded shadow-md"  %>
  <%else%>
    <%= image_tag 'profile_pic_placeholder.png', alt: "Placeholder Image", class: "w-full max-w-sm rounded shadow-md"  %>
<%end%>
</div>

<div class="profile">
  <h1 class="font-medium text-3xl my-4">
    <%=@profile.account.company_name%>
  </h1>

  <div class="mb-2">
    <p class="f_label">
      Country:
    </p>
    <p>
      <%= @profile.country_name %>
    </p>
  </div>

  <div class="mb-2">
    <p class="f_label">
      Street:
    </p>
    <p>
      <%= @profile.street %>
    </p>
  </div>

  <div class="mb-2">
    <p class="f_label">
      Suburb:
    </p>
    <p>
      <%= @profile.suburb %>
    </p>
  </div>

  <div class="mb-2">
    <p class="f_label">
      State:
    </p>
    <p>
      <%= @profile.state %>
    </p>

  </div>
  <div class="mb-2">
    <p class="f_label">
      Postcode:
    </p>
    <p>
      <%= @profile.postcode %>
    </p>
  </div>

  <div class="mb-2">
    <p class="f_label">
      Website:
    </p>
    <p>
      <%= @profile.website %>
    </p>
  </div>

  <div class="mb-2">
    <p class="f_label">
      Contact:
    </p>
    <p>
      <%= @profile.contact %>
    </p>
  </div>

  <%if @profile.account == current_account%>
    <div class="profile-options">
      <%= link_to 'Edit Account', edit_profile_path(@profile), class: "inline-block cursor-pointer bg-blue-200 hover:bg-blue-700 hover:text-white text-black font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" %> |
      <%= link_to 'Delete Account', account_registration_path, method: :delete, data: {confirm: 'Are you sure you want to delete your account?'}, class: "inline-block cursor-pointer bg-red-200 hover:bg-red-700 hover:text-white text-black font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline"  %>
      <%end%>
    </div>
</div>

<!--TODO- MAKE A LISTING CARD-->
<%# Listings of the Profile %>

<h1>Vendor Listings</h1>

<table>
  <thead>
    <tr>
      <th>Primary Photo</th>
      <th>Category</th>
      <th>Account</th>
      <th>Part num</th>
      <th>Part name</th>
      <th>Selling price</th>
      <th>Currency</th>
      <th>Serial num</th>
      <th>Condition</th>
      <th>Form cert</th>
      <th>Cert date</th>
      <th>Expiry date</th>
      <th>Quantity</th>
      <th>Description</th>
      <th>Updated on</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @profile.account.listings.each do |listing| %>
      <tr>
        <%if listing.pictures.empty?%>
          <td><%= image_tag 'profile_pic_placeholder' %></td>
        <%else%>
          <td><%= image_tag listing.pictures.first %></td>
        <%end%>
        <td><%= listing.category.name %></td>
        <td><%= listing.account.company_name %></td>
        <td><%= listing.part_num %></td>
        <td><%= listing.part_name %></td>
        <td><%= number_to_currency(listing.selling_price) %></td>
        <td><%= listing.currency %></td>
        <td><%= listing.serial_num %></td>
        <td><%= listing.condition %></td>
        <td><%= listing.form_cert %></td>
        <td><%= listing.cert_date %></td>
        <td><%= listing.expiry_date %></td>
        <td><%= listing.quantity %></td>
        <td><%= listing.description %></td>
        <td><%=listing.updated_at.to_date%></td>
        <td><%= link_to 'Show', listing %></td>
        <%if listing.account == current_account %>
        <td><%= link_to 'Edit', edit_listing_path(listing) %></td>
        <td><%= link_to 'Destroy', listing, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <%end%>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<%if current_account == @profile.account%>
  <%= link_to 'New Listing', new_listing_path %>
<%end%>